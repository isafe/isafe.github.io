<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title><![CDATA[iSec]]></title>
  
  <link href="/atom.xml" rel="self"/>
  <link href="http://blog.isec.me/"/>
  <updated>2015-05-30T00:01:36.000Z</updated>
  <id>http://blog.isec.me/</id>
  
  <author>
    <name><![CDATA[苏格兰雨季]]></name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title><![CDATA[Google Authenticator + SSH public key 实现两步认证]]></title>
    <link href="http://blog.isec.me/2015/05/29/Google-Authenticator-SSH-public-key-%E5%AE%9E%E7%8E%B0%E4%B8%A4%E6%AD%A5%E8%AE%A4%E8%AF%81/"/>
    <id>http://blog.isec.me/2015/05/29/Google-Authenticator-SSH-public-key-实现两步认证/</id>
    <published>2015-05-29T23:58:19.000Z</published>
    <updated>2015-05-30T00:01:36.000Z</updated>
    <content type="html"><![CDATA[<p>OpenSSH 版本6.2以上才支持AuthenticationMethods</p>
<p>1,安装依赖：<br>Red Hat, CentOS， Fedora 系统需要安装 pam-devel 包:</p>
<pre><code><span class="comment">yum</span> <span class="comment">install</span> <span class="comment">git</span> <span class="comment">pam</span><span class="literal">-</span><span class="comment">devel</span> <span class="comment">make</span> <span class="comment">gcc</span><span class="literal">-</span><span class="comment">c</span><span class="literal">+</span><span class="literal">+</span> <span class="comment">wget</span> <span class="literal">-</span><span class="comment">y</span>
</code></pre><p>Ubuntu，Linux Mint，Debian 系统需要安装‘libpam0g-dev包:</p>
<pre><code>apt-<span class="built_in">get</span> install git libpam0g-<span class="built_in">dev</span> make gcc-c++ wget -y
</code></pre><p>2,谷歌身份验证器模块：</p>
<pre><code>git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/google/google-authenticator.git
<span class="keyword">cd</span> google-authenticator/libpam
./bootstrap.<span class="keyword">sh</span>
<span class="keyword">make</span> &amp;&amp; <span class="keyword">make</span> install
</code></pre><p>3,运行google-authenticator开始生成密钥信息</p>
<pre><code>google-authenticator 

<span class="operator"><span class="keyword">Do</span> you want authentication tokens <span class="keyword">to</span> be <span class="keyword">time</span>-based (y/n) y
二维码地址
https://www.google.com/chart?chs=<span class="number">200</span>x200&amp;chld=M|<span class="number">0</span>&amp;cht=qr&amp;chl=otpauth://totp/root@localhost%<span class="number">3</span>Fsecret%XXXXXXXXXXXXXX
Your new secret <span class="keyword">key</span> <span class="keyword">is</span>: XXXXXXXXXXXX
Your verification code <span class="keyword">is</span> <span class="number">000000</span>
紧急码,只能使用一次
Your emergency scratch codes <span class="keyword">are</span>:
  <span class="number">80801116</span>
  <span class="number">43011118</span>
  <span class="number">34981118</span>
  <span class="number">88321117</span>
  <span class="number">93711113</span>

<span class="keyword">Do</span> you want me <span class="keyword">to</span> <span class="keyword">update</span> your <span class="string">"/root/.google_authenticator"</span> file (y/n) y

<span class="keyword">Do</span> you want <span class="keyword">to</span> disallow multiple uses <span class="keyword">of</span> the same authentication
token? This restricts you <span class="keyword">to</span> one login about every <span class="number">30</span>s, but it increases
your chances <span class="keyword">to</span> notice <span class="keyword">or</span> even prevent man-<span class="keyword">in</span>-the-middle attacks (y/n) y
#每<span class="number">30</span>秒生成一个token
<span class="keyword">By</span> <span class="keyword">default</span>, tokens <span class="keyword">are</span> good <span class="keyword">for</span> <span class="number">30</span> seconds <span class="keyword">and</span> <span class="keyword">in</span> <span class="keyword">order</span> <span class="keyword">to</span> compensate <span class="keyword">for</span>
possible <span class="keyword">time</span>-skew <span class="keyword">between</span> the client <span class="keyword">and</span> the <span class="keyword">server</span>, we allow an extra
token <span class="keyword">before</span> <span class="keyword">and</span> <span class="keyword">after</span> the <span class="keyword">current</span> <span class="keyword">time</span>. <span class="keyword">If</span> you experience problems <span class="keyword">with</span> poor
<span class="keyword">time</span> synchronization, you can increase the window <span class="keyword">from</span> its <span class="keyword">default</span>
<span class="keyword">size</span> <span class="keyword">of</span> <span class="number">1</span>:<span class="number">30</span><span class="keyword">min</span> <span class="keyword">to</span> about <span class="number">4</span><span class="keyword">min</span>. <span class="keyword">Do</span> you want <span class="keyword">to</span> <span class="keyword">do</span> so (y/n) y

<span class="keyword">If</span> the computer that you <span class="keyword">are</span> logging <span class="keyword">into</span> isn<span class="string">'t hardened against brute-force
login attempts, you can enable rate-limiting for the authentication module.
By default, this limits attackers to no more than 3 login attempts every 30s.
Do you want to enable rate-limiting (y/n) y</span></span>
</code></pre><p>3,配置SSH使用谷歌身份验证器模块</p>
<p>编辑/etc/pam.d/sshd 添加如下：</p>
<pre><code>auth sufficient pam_google_authenticator.so
注释：
auth       <span class="literal">include</span>      <span class="literal">password</span>-auth
</code></pre><p>编辑/etc/ssh/sshd_config,修改</p>
<pre><code><span class="title">PubkeyAuthentication</span> <span class="built_in">yes</span>
ChallengeResponseAuthentication <span class="built_in">yes</span>
AuthenticationMethods publickey,keyboard-interactive
PasswordAuthentication <span class="built_in">no</span>
UsePAM <span class="built_in">yes</span>
</code></pre><p>重启SSH服务:</p>
<pre><code><span class="keyword">service</span> sshd <span class="literal">restart</span>
</code></pre><p>手机端安装Google 身份验证器:<br>Andorid版<br><a href="https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2" target="_blank" rel="external">https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2</a><br>iOS版<br><a href="https://itunes.apple.com/cn/app/google-authenticator/id388497605" target="_blank" rel="external">https://itunes.apple.com/cn/app/google-authenticator/id388497605</a><br>手机端打开google 身份验证器,扫二维码或者输入secret key</p>
<pre><code>[root<span class="property">@localhost</span> ~]<span class="comment"># ssh 127.0.0.1</span>
Authenticated <span class="keyword">with</span> partial success.
Verification <span class="attribute">code</span>: <span class="number">6</span>位动态码
Last <span class="attribute">login</span>: Thu Aug <span class="number">14</span> <span class="number">15</span>:<span class="number">20</span>:<span class="number">16</span> <span class="number">2015</span> <span class="keyword">from</span> <span class="number">127.0</span>.<span class="number">0.1</span>
[root<span class="property">@localhost</span> ~]<span class="comment"># </span>
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<p>OpenSSH 版本6.2以上才支持AuthenticationMethods</p>
<p>1,安装依赖：<br>Red Hat, CentOS， Fedora 系统需要安装 pam-devel 包:</p>
<pre><code><span class="comment]]>
    </summary>
    
      <category term="Linux安全" scheme="http://blog.isec.me/tags/Linux%E5%AE%89%E5%85%A8/"/>
    
      <category term="安全" scheme="http://blog.isec.me/tags/%E5%AE%89%E5%85%A8/"/>
    
      <category term="Linux安全" scheme="http://blog.isec.me/categories/Linux%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Postgresql常用命令]]></title>
    <link href="http://blog.isec.me/2015/05/28/Postgresql%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <id>http://blog.isec.me/2015/05/28/Postgresql常用命令/</id>
    <published>2015-05-29T00:11:06.000Z</published>
    <updated>2015-05-29T00:12:04.000Z</updated>
    <content type="html"><![CDATA[<p>连接数据库, 默认的用户和数据库是postgres</p>
<pre><code>psql -<span class="keyword">U</span> user -<span class="keyword">d</span> dbname
</code></pre><p>切换数据库,相当于mysql的use dbname</p>
<pre><code><span class="string">\c</span> dbname
</code></pre><p>列举数据库，相当于mysql的show databases</p>
<pre><code><span class="string">\l</span>
</code></pre><p>列举表，相当于mysql的show tables</p>
<pre><code><span class="string">\dt</span>
</code></pre><p>查看表结构，相当于desc tblname,show columns from tbname</p>
<pre><code><span class="string">\d</span> tblname
</code></pre><p>查看索引</p>
<pre><code><span class="string">\di</span> 
</code></pre><p>创建数据库：</p>
<pre><code><span class="operator"><span class="keyword">create</span> <span class="keyword">database</span> dbname;</span>
<span class="operator"><span class="keyword">create</span> <span class="keyword">database</span> dbname OWNER rolename;</span>
</code></pre><p>删除数据库： </p>
<pre><code><span class="operator"><span class="keyword">drop</span> <span class="keyword">database</span> dbname;</span>  
</code></pre><p>重命名一个表： </p>
<pre><code><span class="operator"><span class="keyword">alter</span> <span class="keyword">table</span> oldtablename <span class="keyword">rename</span> <span class="keyword">to</span> newtablename;</span> 
</code></pre><p>删除一个表： </p>
<pre><code><span class="operator"><span class="keyword">drop</span> <span class="keyword">table</span> tablename;</span> 
</code></pre>]]></content>
    <summary type="html">
    <![CDATA[<p>连接数据库, 默认的用户和数据库是postgres</p>
<pre><code>psql -<span class="keyword">U</span> user -<span class="keyword">d</span> dbname
</code></pre><p]]>
    </summary>
    
      <category term="Postgresql" scheme="http://blog.isec.me/tags/Postgresql/"/>
    
      <category term="运维" scheme="http://blog.isec.me/categories/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[CentOS 6.5 源码安装PostgreSQL]]></title>
    <link href="http://blog.isec.me/2015/05/27/CentOS-6-5-%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85PostgreSQL/"/>
    <id>http://blog.isec.me/2015/05/27/CentOS-6-5-源码安装PostgreSQL/</id>
    <published>2015-05-28T00:02:40.000Z</published>
    <updated>2015-05-29T00:12:22.000Z</updated>
    <content type="html"><![CDATA[<h3 id="安装依赖：">安装依赖：</h3><pre><code>yum install <span class="keyword">readline</span> <span class="keyword">readline</span>-devel make zlib zlib-devel 
</code></pre><h3 id="下载源码：">下载源码：</h3><pre><code>wget <span class="string">https:</span><span class="comment">//ftp.postgresql.org/pub/source/v9.3.2/postgresql-9.3.2.tar.gz</span>
tar -zxf postgresql-<span class="number">9.3</span>.2.tar.gz
cd postgresql-<span class="number">9.3</span>.2
.<span class="regexp">/configure --prefix=/</span>usr<span class="regexp">/local/</span>pgsql  --with-openssl 
gmake
gmake install
</code></pre><h3 id="添加postgres用户，PostgreSQL的默认超级管理员">添加postgres用户，PostgreSQL的默认超级管理员</h3><pre><code>groupadd postgres    
adduser -g postgres postgres
mkdir <span class="regexp">/usr/</span>local<span class="regexp">/pgsql/</span>data
chown <span class="string">postgres:</span>postgres <span class="regexp">/usr/</span>local<span class="regexp">/pgsql/</span>data
</code></pre><h3 id="测试">测试</h3><pre><code>su - postgres
<span class="regexp">/usr/</span>local<span class="regexp">/pgsql/</span>bin<span class="regexp">/psql -V</span>
</code></pre><h3 id="初始数据库的存储区间">初始数据库的存储区间</h3><pre><code><span class="regexp">/usr/</span>local<span class="regexp">/pgsql/</span>bin<span class="regexp">/initdb -D /u</span>sr<span class="regexp">/local/</span>pgsql<span class="regexp">/data --locale=en_US.UTF8 -U postgres</span>
</code></pre><h3 id="启动数据库服务器">启动数据库服务器</h3><pre><code>cp contrib<span class="regexp">/start-scripts/</span>linux <span class="regexp">/etc/</span>init.d/postgresql
chmod a+x <span class="regexp">/etc/</span>init.d/postgresql
<span class="regexp">/etc/</span>init.d/postgresql start
</code></pre><h3 id="连接进数据库">连接进数据库</h3><pre><code>/usr/<span class="keyword">local</span>/pgsql/bin/createdb <span class="keyword">test</span>
/usr/<span class="keyword">local</span>/pgsql/bin/psql -<span class="keyword">U</span> postgres <span class="keyword">test</span>
</code></pre><h3 id="配置一下动态连接库的搜索路径和环境变量">配置一下动态连接库的搜索路径和环境变量</h3><p>在~./bash_profile添加如下内容：</p>
<pre><code>PGHOME=/usr/<span class="built_in">local</span>/pgsql
PGDATA=<span class="variable">$PGHOME</span>/data
PATH=<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/bin:<span class="variable">$PGHOME</span>/bin
<span class="built_in">export</span> PGHOME
<span class="built_in">export</span> PGDATA
<span class="built_in">export</span> PATH
----------------------------
LD_LIBRARY_PATH=/usr/<span class="built_in">local</span>/pgsql/lib
<span class="built_in">export</span> LD_LIBRARY_PATH 
PATH=/usr/<span class="built_in">local</span>/pgsql/bin:<span class="variable">$PATH</span>
<span class="built_in">export</span> PATH
</code></pre><p>PostgreSQL9.3安装完成。</p>
]]></content>
    <summary type="html">
    <![CDATA[<h3 id="安装依赖：">安装依赖：</h3><pre><code>yum install <span class="keyword">readline</span> <span class="keyword">readline</span>-devel make zlib ]]>
    </summary>
    
      <category term="PostgreSQL" scheme="http://blog.isec.me/tags/PostgreSQL/"/>
    
      <category term="运维" scheme="http://blog.isec.me/categories/%E8%BF%90%E7%BB%B4/"/>
    
  </entry>
  
  <entry>
    <title><![CDATA[Hexo静态博客使用指南]]></title>
    <link href="http://blog.isec.me/2015/05/24/Hexo%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
    <id>http://blog.isec.me/2015/05/24/Hexo静态博客使用指南/</id>
    <published>2015-05-24T23:41:36.000Z</published>
    <updated>2015-05-28T00:01:32.000Z</updated>
    <content type="html"><![CDATA[<p>安装Hexo<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install npm -<span class="literal">y</span></span><br><span class="line">npm config <span class="keyword">set</span> registry http:<span class="comment">//registry.npm.taobao.org/</span></span><br><span class="line">npm install hexo-<span class="keyword">cli</span> -<span class="keyword">g</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="label">hexo</span> init <span class="keyword">blog</span><br><span class="line"></span><span class="label">cd</span> <span class="keyword">blog</span></span><br></pre></td></tr></table></figure>
<p>Hexo常用插件安装与配置</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="operator"><span class="keyword">install</span> hexo <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-<span class="keyword">index</span> <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-archive <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-category <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-generator-tag <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-<span class="keyword">server</span> <span class="comment">--save</span></span><br><span class="line">npm <span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> blog</span><br><span class="line">npm install</span><br><span class="line"><span class="keyword">cd</span> themes</span><br><span class="line">git clone http<span class="variable">s:</span>//github.<span class="keyword">com</span>/moretwo/hexo-theme.git</span><br></pre></td></tr></table></figure>
]]></content>
    <summary type="html">
    <![CDATA[<p>安装Hexo<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><b]]>
    </summary>
    
      <category term="Github" scheme="http://blog.isec.me/tags/Github/"/>
    
      <category term="Hexo" scheme="http://blog.isec.me/tags/Hexo/"/>
    
      <category term="Hexo" scheme="http://blog.isec.me/categories/Hexo/"/>
    
  </entry>
  
</feed>